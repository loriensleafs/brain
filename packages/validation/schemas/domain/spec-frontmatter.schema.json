{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://brain.dev/schemas/domain/spec-frontmatter.json",
  "title": "SpecFrontmatter",
  "description": "Schema for specification file YAML frontmatter. Validates REQ, DESIGN, and TASK spec frontmatter.",
  "type": "object",
  "properties": {
    "type": {
      "type": "string",
      "enum": ["requirement", "design", "task"],
      "description": "Specification type"
    },
    "id": {
      "type": "string",
      "pattern": "^(REQ|DESIGN|TASK)-[A-Z0-9]+$",
      "description": "Specification ID (e.g., REQ-001, DESIGN-ABC, TASK-001)"
    },
    "status": {
      "type": "string",
      "enum": ["draft", "review", "approved", "pending", "in-progress", "complete", "done", "implemented", "rejected", "deferred"],
      "description": "Current status of the specification"
    },
    "related": {
      "type": "array",
      "items": {
        "type": "string",
        "pattern": "^(REQ|DESIGN|TASK)-[A-Z0-9]+$"
      },
      "uniqueItems": true,
      "description": "Related specification IDs for traceability"
    },
    "filePath": {
      "type": "string",
      "description": "File path (runtime metadata, not from YAML)"
    }
  },
  "required": ["type", "id", "status"],
  "additionalProperties": true,
  "allOf": [
    {
      "if": {
        "properties": { "type": { "const": "requirement" } }
      },
      "then": {
        "properties": {
          "id": { "pattern": "^REQ-[A-Z0-9]+$" }
        }
      }
    },
    {
      "if": {
        "properties": { "type": { "const": "design" } }
      },
      "then": {
        "properties": {
          "id": { "pattern": "^DESIGN-[A-Z0-9]+$" }
        }
      }
    },
    {
      "if": {
        "properties": { "type": { "const": "task" } }
      },
      "then": {
        "properties": {
          "id": { "pattern": "^TASK-[A-Z0-9]+$" }
        }
      }
    }
  ]
}
